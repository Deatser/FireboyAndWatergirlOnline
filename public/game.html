<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<title>Игра</title>
		<style>
			body {
				margin: 0;
				background: #111;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				height: 100vh;
				font-family: sans-serif;
				flex-direction: column;
			}
			.box {
				background: #222;
				border-radius: 20px;
				width: 80%;
				height: 70%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 2em;
				margin-bottom: 20px;
			}
			button {
				padding: 10px 20px;
				font-size: 1.2em;
				border: none;
				border-radius: 10px;
				cursor: pointer;
				background: #ff5555;
				color: white;
			}
			button:hover {
				background: #ff2222;
			}
		</style>

		<!-- Проверка isPlaying до рендера страницы -->
		<script type="module">
			import { db } from './js/firebase-config.js'
			import {
				ref,
				get,
			} from 'https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js'

			const playerUid = localStorage.getItem('playerUid')
			if (!playerUid) {
				window.location.replace('index.html')
			} else {
				;(async () => {
					try {
						const snap = await get(ref(db, `users/${playerUid}/isPlaying`))
						if (!snap.val()) {
							window.location.replace('index.html')
						}
					} catch (err) {
						console.error(err)
						window.location.replace('index.html')
					}
				})()
			}
		</script>
	</head>
	<body>
		<div class="box">Игра скоро начнется...</div>
		<button id="endGameBtn">Закончить игру (тест)</button>

		<script type="module" src="./js/game.js"></script>
	</body>
</html>
